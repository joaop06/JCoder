{"version":3,"sources":["turbopack:///[project]/app/[username]/admin/messages/page.tsx","turbopack:///[project]/services/administration-by-user/messages.service.ts"],"sourcesContent":["'use client';\r\n\r\nimport Footer from '@/components/Footer';\r\nimport Header from '@/components/Header';\r\nimport { User } from '@/types/api/users/user.entity';\r\nimport { useParams, useRouter } from 'next/navigation';\r\nimport { useToast } from '@/components/toast/ToastContext';\r\nimport WebGLBackground from '@/components/webgl/WebGLBackground';\r\nimport { ConversationResponseDto, Message } from '@/types/api/messages';\r\nimport { UsersService } from '@/services/administration-by-user/users.service';\r\nimport { useState, useEffect, useCallback, useMemo, Suspense, useRef } from 'react';\r\nimport { MessagesService } from '@/services/administration-by-user/messages.service';\r\n\r\nexport default function MessagesManagementPage() {\r\n    const router = useRouter();\r\n    const params = useParams();\r\n    const username = useMemo(() => {\r\n        const raw = params?.username;\r\n        return Array.isArray(raw) ? raw[0] : raw || '';\r\n    }, [params]);\r\n\r\n    const [loading, setLoading] = useState(true);\r\n    const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n    const [checkingAuth, setCheckingAuth] = useState(true);\r\n    const [user, setUser] = useState<User | null>(null);\r\n    const [conversations, setConversations] = useState<ConversationResponseDto[]>([]);\r\n    const [selectedConversation, setSelectedConversation] = useState<ConversationResponseDto | null>(null);\r\n    const [messages, setMessages] = useState<Message[]>([]);\r\n    const [loadingMessages, setLoadingMessages] = useState(false);\r\n    const [markingAsRead, setMarkingAsRead] = useState(false);\r\n    const [newMessagesDividerIndex, setNewMessagesDividerIndex] = useState<number | null>(null);\r\n    const [showNewMessagesDivider, setShowNewMessagesDivider] = useState(false);\r\n\r\n    // Mobile view state - show conversations list or messages view\r\n    const [mobileView, setMobileView] = useState<'conversations' | 'messages'>('conversations');\r\n\r\n    // WebGL and animation states\r\n    const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });\r\n    const [windowSize, setWindowSize] = useState({ width: 1920, height: 1080 });\r\n    const [isVisible, setIsVisible] = useState(false);\r\n\r\n    // Refs for mouse position throttling\r\n    const mousePositionRef = useRef({ x: 0, y: 0 });\r\n    const rafRef = useRef<number | null>(null);\r\n    const messagesEndRef = useRef<HTMLDivElement>(null);\r\n    const messagesContainerRef = useRef<HTMLDivElement>(null);\r\n    const messagesContainerMobileRef = useRef<HTMLDivElement>(null);\r\n\r\n    const toast = useToast();\r\n\r\n    useEffect(() => {\r\n        setIsVisible(true);\r\n\r\n        const updateWindowSize = () => {\r\n            setWindowSize({ width: window.innerWidth, height: window.innerHeight });\r\n        };\r\n        updateWindowSize();\r\n        window.addEventListener('resize', updateWindowSize);\r\n        return () => window.removeEventListener('resize', updateWindowSize);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const handleMouseMove = (e: MouseEvent) => {\r\n            mousePositionRef.current = { x: e.clientX, y: e.clientY };\r\n\r\n            if (rafRef.current === null) {\r\n                rafRef.current = requestAnimationFrame(() => {\r\n                    setMousePosition(mousePositionRef.current);\r\n                    rafRef.current = null;\r\n                });\r\n            }\r\n        };\r\n\r\n        window.addEventListener('mousemove', handleMouseMove, { passive: true });\r\n        return () => {\r\n            window.removeEventListener('mousemove', handleMouseMove);\r\n            if (rafRef.current !== null) {\r\n                cancelAnimationFrame(rafRef.current);\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const token = typeof window !== 'undefined' ? localStorage.getItem('accessToken') : null;\r\n        if (!token) {\r\n            router.push('/sign-in');\r\n            return;\r\n        }\r\n\r\n        const loadUserProfile = async () => {\r\n            try {\r\n                if (username) {\r\n                    const userProfile = await UsersService.getProfile(username);\r\n                    setUser(userProfile);\r\n                } else {\r\n                    const userSession = UsersService.getUserSession();\r\n                    if (userSession?.user) {\r\n                        setUser(userSession.user);\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error('Error loading user profile:', error);\r\n                const userSession = UsersService.getUserSession();\r\n                if (userSession?.user) {\r\n                    setUser(userSession.user);\r\n                }\r\n            }\r\n        };\r\n\r\n        setIsAuthenticated(true);\r\n        setCheckingAuth(false);\r\n        loadUserProfile();\r\n    }, [router, username]);\r\n\r\n    const fetchConversations = useCallback(async () => {\r\n        setLoading(true);\r\n        try {\r\n            const userSession = UsersService.getUserSession();\r\n            if (!userSession?.user?.username) {\r\n                throw new Error('User session not found');\r\n            }\r\n            const data = await MessagesService.findAllConversations(userSession.user.username);\r\n            // Ensure data is always an array\r\n            setConversations(Array.isArray(data) ? data : []);\r\n        } catch (err: any) {\r\n            const errorMessage = 'Failed to load conversations. Please try again.';\r\n            toast.error(errorMessage);\r\n            console.error('Error fetching conversations:', err);\r\n            setConversations([]);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [toast]);\r\n\r\n    const fetchMessages = useCallback(async (conversationId: number): Promise<Message[]> => {\r\n        setLoadingMessages(true);\r\n        try {\r\n            const userSession = UsersService.getUserSession();\r\n            if (!userSession?.user?.username) {\r\n                throw new Error('User session not found');\r\n            }\r\n            const data = await MessagesService.findMessagesByConversation(\r\n                userSession.user.username,\r\n                conversationId,\r\n            );\r\n            // Ensure data is always an array\r\n            const messagesArray = Array.isArray(data) ? data : [];\r\n            setMessages(messagesArray);\r\n            return messagesArray;\r\n        } catch (err: any) {\r\n            toast.error('Failed to load messages. Please try again.');\r\n            console.error('Error fetching messages:', err);\r\n            setMessages([]);\r\n            return [];\r\n        } finally {\r\n            setLoadingMessages(false);\r\n        }\r\n    }, [toast]);\r\n\r\n    const markAsRead = useCallback(async (conversationId: number, messageIds: number[]) => {\r\n        if (markingAsRead || messageIds.length === 0) return;\r\n\r\n        setMarkingAsRead(true);\r\n        try {\r\n            const userSession = UsersService.getUserSession();\r\n            if (!userSession?.user?.username) {\r\n                throw new Error('User session not found');\r\n            }\r\n            await MessagesService.markMessagesAsRead(\r\n                userSession.user.username,\r\n                conversationId,\r\n                { messageIds },\r\n            );\r\n\r\n            // Update local messages state first\r\n            setMessages(prev => prev.map(msg => {\r\n                if (!messageIds.includes(msg.id)) {\r\n                    return msg;\r\n                }\r\n                return {\r\n                    ...msg,\r\n                    readAt: msg.readAt || new Date().toISOString(),\r\n                };\r\n            }));\r\n\r\n            // Refresh conversations to update unread count\r\n            const updatedConversations = await MessagesService.findAllConversations(userSession.user.username);\r\n            const conversationsArray = Array.isArray(updatedConversations) ? updatedConversations : [];\r\n            setConversations(conversationsArray);\r\n\r\n            // Update selected conversation with the updated data\r\n            const updatedConversation = conversationsArray.find(c => c.id === conversationId);\r\n            if (updatedConversation) {\r\n                setSelectedConversation(updatedConversation);\r\n            }\r\n        } catch (err: any) {\r\n            toast.error('Failed to mark messages as read.');\r\n            console.error('Error marking messages as read:', err);\r\n        } finally {\r\n            setMarkingAsRead(false);\r\n        }\r\n    }, [toast, markingAsRead]);\r\n\r\n    useEffect(() => {\r\n        if (!isAuthenticated) return;\r\n        fetchConversations();\r\n    }, [isAuthenticated, fetchConversations]);\r\n\r\n    // Scroll to bottom when messages change or conversation is selected\r\n    useEffect(() => {\r\n        if (messages.length > 0 && !loadingMessages) {\r\n            // Use requestAnimationFrame to ensure DOM is fully rendered\r\n            requestAnimationFrame(() => {\r\n                requestAnimationFrame(() => {\r\n                    // Scroll desktop container\r\n                    if (messagesContainerRef.current) {\r\n                        messagesContainerRef.current.scrollTop = messagesContainerRef.current.scrollHeight;\r\n                    }\r\n                    // Scroll mobile container\r\n                    if (messagesContainerMobileRef.current) {\r\n                        messagesContainerMobileRef.current.scrollTop = messagesContainerMobileRef.current.scrollHeight;\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    }, [messages, loadingMessages, selectedConversation]);\r\n\r\n    // Hide new messages divider after a few seconds\r\n    useEffect(() => {\r\n        if (showNewMessagesDivider) {\r\n            const timer = setTimeout(() => {\r\n                setShowNewMessagesDivider(false);\r\n                // Clear the index after fade out animation completes\r\n                setTimeout(() => {\r\n                    setNewMessagesDividerIndex(null);\r\n                }, 500); // Wait for fade out animation (500ms)\r\n            }, 3000); // Show for 3 seconds\r\n\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [showNewMessagesDivider]);\r\n\r\n    const handleSelectConversation = useCallback(async (conversation: ConversationResponseDto) => {\r\n        setSelectedConversation(conversation);\r\n        const loadedMessages = await fetchMessages(conversation.id);\r\n\r\n        // Find the index of the first unread message\r\n        const firstUnreadIndex = loadedMessages.findIndex(msg => !msg.readAt);\r\n\r\n        // If there are unread messages and there are also read messages before them, show divider\r\n        if (firstUnreadIndex > 0 && firstUnreadIndex !== -1) {\r\n            setNewMessagesDividerIndex(firstUnreadIndex);\r\n            setShowNewMessagesDivider(true);\r\n        } else {\r\n            setNewMessagesDividerIndex(null);\r\n            setShowNewMessagesDivider(false);\r\n        }\r\n\r\n        // Get IDs of unread messages (readAt is null/undefined) and mark them as read\r\n        const unreadMessageIds = loadedMessages\r\n            .filter(msg => !msg.readAt)\r\n            .map(msg => msg.id);\r\n\r\n        // Only mark as read if there are unread messages with valid IDs\r\n        if (unreadMessageIds.length > 0) {\r\n            await markAsRead(conversation.id, unreadMessageIds);\r\n        }\r\n\r\n        // On mobile, switch to messages view\r\n        if (windowSize.width < 768) {\r\n            setMobileView('messages');\r\n        }\r\n    }, [fetchMessages, markAsRead, windowSize.width]);\r\n\r\n    const handleBackToConversations = useCallback(() => {\r\n        setMobileView('conversations');\r\n        setSelectedConversation(null);\r\n        setMessages([]);\r\n        setNewMessagesDividerIndex(null);\r\n        setShowNewMessagesDivider(false);\r\n    }, []);\r\n\r\n    const formatDate = useCallback((date: Date | string | undefined): string => {\r\n        if (!date) return '';\r\n        const d = typeof date === 'string' ? new Date(date) : date;\r\n        if (isNaN(d.getTime())) return '';\r\n\r\n        const now = new Date();\r\n        const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\r\n        const messageDate = new Date(d.getFullYear(), d.getMonth(), d.getDate());\r\n        const yesterday = new Date(today);\r\n        yesterday.setDate(yesterday.getDate() - 1);\r\n\r\n        if (messageDate.getTime() === today.getTime()) {\r\n            return d.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });\r\n        } else if (messageDate.getTime() === yesterday.getTime()) {\r\n            return 'Yesterday';\r\n        } else {\r\n            return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: d.getFullYear() !== now.getFullYear() ? 'numeric' : undefined });\r\n        }\r\n    }, []);\r\n\r\n    const formatMessageTime = useCallback((date: Date | string | undefined): string => {\r\n        if (!date) return '';\r\n        const d = typeof date === 'string' ? new Date(date) : date;\r\n        if (isNaN(d.getTime())) return '';\r\n        return d.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });\r\n    }, []);\r\n\r\n    const getInitials = useCallback((name: string): string => {\r\n        const parts = name.trim().split(' ');\r\n        if (parts.length >= 2) {\r\n            return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();\r\n        }\r\n        return name.substring(0, 2).toUpperCase();\r\n    }, []);\r\n\r\n    const handleLogout = useCallback(() => {\r\n        localStorage.removeItem('user');\r\n        localStorage.removeItem('accessToken');\r\n        router.push('/');\r\n    }, [router]);\r\n\r\n    if (checkingAuth || !isAuthenticated) {\r\n        return (\r\n            <div className=\"min-h-screen flex flex-col bg-background overflow-hidden relative\">\r\n                <div className=\"hidden md:block\">\r\n                    <Suspense fallback={null}>\r\n                        <WebGLBackground mouse={mousePosition} windowSize={windowSize} />\r\n                    </Suspense>\r\n                </div>\r\n\r\n                <div className=\"fixed inset-0 overflow-hidden pointer-events-none z-0\">\r\n                    <div\r\n                        className=\"absolute w-48 h-48 sm:w-64 sm:h-64 md:w-96 md:h-96 bg-jcoder-cyan/20 rounded-full blur-3xl animate-pulse\"\r\n                        style={{\r\n                            left: `${mousePosition.x / 20}px`,\r\n                            top: `${mousePosition.y / 20}px`,\r\n                            transition: 'all 0.3s ease-out',\r\n                        }}\r\n                    />\r\n                    <div\r\n                        className=\"absolute w-48 h-48 sm:w-64 sm:h-64 md:w-96 md:h-96 bg-jcoder-blue/20 rounded-full blur-3xl animate-pulse delay-1000\"\r\n                        style={{\r\n                            right: `${mousePosition.x / 25}px`,\r\n                            bottom: `${mousePosition.y / 25}px`,\r\n                            transition: 'all 0.3s ease-out',\r\n                        }}\r\n                    />\r\n                    <div className=\"absolute inset-0 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:16px_16px] md:bg-[size:24px_24px]\" />\r\n                </div>\r\n\r\n                <Header isAdmin={true} onLogout={handleLogout} />\r\n                <main className=\"flex-1 container mx-auto px-4 sm:px-6 lg:px-8 pt-16 sm:pt-24 pb-6 sm:pb-12 relative z-10\">\r\n                    <div className=\"max-w-7xl mx-auto\">\r\n                        <div className=\"h-8 sm:h-10 w-48 sm:w-64 bg-jcoder-secondary rounded-lg mb-2 animate-pulse\"></div>\r\n                        <div className=\"h-3 sm:h-4 w-64 sm:w-96 bg-jcoder-secondary rounded-lg animate-pulse\"></div>\r\n                    </div>\r\n                </main>\r\n                <Footer user={user} username={username || user?.username} />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex flex-col bg-background overflow-hidden relative\">\r\n            {/* WebGL Background - Hidden on mobile */}\r\n            <div className=\"hidden md:block\">\r\n                <Suspense fallback={null}>\r\n                    <WebGLBackground mouse={mousePosition} windowSize={windowSize} />\r\n                </Suspense>\r\n            </div>\r\n\r\n            {/* Animated Background */}\r\n            <div className=\"fixed inset-0 overflow-hidden pointer-events-none z-0\">\r\n                <div\r\n                    className=\"absolute w-48 h-48 sm:w-64 sm:h-64 md:w-96 md:h-96 bg-jcoder-cyan/20 rounded-full blur-3xl animate-pulse\"\r\n                    style={{\r\n                        left: `${mousePosition.x / 20}px`,\r\n                        top: `${mousePosition.y / 20}px`,\r\n                        transition: 'all 0.3s ease-out',\r\n                    }}\r\n                />\r\n                <div\r\n                    className=\"absolute w-48 h-48 sm:w-64 sm:h-64 md:w-96 md:h-96 bg-jcoder-blue/20 rounded-full blur-3xl animate-pulse delay-1000\"\r\n                    style={{\r\n                        right: `${mousePosition.x / 25}px`,\r\n                        bottom: `${mousePosition.y / 25}px`,\r\n                        transition: 'all 0.3s ease-out',\r\n                    }}\r\n                />\r\n                <div className=\"absolute inset-0 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:16px_16px] md:bg-[size:24px_24px]\" />\r\n            </div>\r\n\r\n            <Header isAdmin={true} onLogout={handleLogout} />\r\n\r\n            <main className=\"flex-1 container mx-auto px-4 sm:px-6 lg:px-8 pt-16 sm:pt-24 pb-6 sm:pb-12 relative z-10\">\r\n                <div className={`max-w-7xl mx-auto transition-all duration-1000 h-full md:h-auto ${isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}`}>\r\n                    {/* Breadcrumb */}\r\n                    <nav className=\"mb-4 px-4 mt-4 md:mt-0\">\r\n                        <ol className=\"flex items-center gap-2 text-sm text-jcoder-muted\">\r\n                            <li>\r\n                                <button onClick={() => router.push(`/${username}/admin`)} className=\"hover:text-jcoder-primary transition-colors group cursor-pointer\">\r\n                                    <span className=\"group-hover:underline\">Dashboard</span>\r\n                                </button>\r\n                            </li>\r\n                            <li>\r\n                                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\r\n                                </svg>\r\n                            </li>\r\n                            <li className=\"text-jcoder-foreground font-medium\">Messages</li>\r\n                        </ol>\r\n                    </nav>\r\n\r\n                    {/* Page Header */}\r\n                    <div className=\"mb-2 sm:mb-4 md:mb-6 px-4\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <h1 className=\"text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold text-jcoder-foreground\">\r\n                                Messages\r\n                            </h1>\r\n                        </div>\r\n                        <p className=\"text-xs sm:text-sm md:text-base text-jcoder-muted mt-1 sm:mt-2\">Manage and view messages from your portfolio visitors</p>\r\n                    </div>\r\n\r\n                    {/* Messages Container - WhatsApp-like layout */}\r\n                    <div className=\"bg-jcoder-card border border-jcoder rounded-xl sm:rounded-2xl overflow-hidden shadow-xl shadow-jcoder-primary/10 h-[calc(100vh-12rem)] md:h-[calc(100vh-36rem)] flex flex-col px-2 md:px-0\">\r\n                        {/* Desktop: Side-by-side layout */}\r\n                        <div className=\"hidden md:flex flex-1 overflow-hidden\">\r\n                            {/* Conversations Sidebar */}\r\n                            <div className=\"w-80 border-r border-jcoder flex flex-col bg-jcoder-card\">\r\n                                {/* Conversations Header */}\r\n                                <div className=\"p-4 border-b border-jcoder bg-jcoder-card\">\r\n                                    <h2 className=\"text-lg font-semibold text-jcoder-foreground\">Conversations</h2>\r\n                                    <p className=\"text-xs text-jcoder-muted mt-1\">\r\n                                        {conversations.length} {conversations.length === 1 ? 'conversation' : 'conversations'}\r\n                                    </p>\r\n                                </div>\r\n\r\n                                {/* Conversations List */}\r\n                                <div className=\"flex-1 overflow-y-auto\">\r\n                                    {loading ? (\r\n                                        <div className=\"p-4 space-y-3\">\r\n                                            {[1, 2, 3].map((i) => (\r\n                                                <div key={i} className=\"flex items-center gap-3 p-3 bg-jcoder-secondary rounded-lg animate-pulse\">\r\n                                                    <div className=\"w-12 h-12 rounded-full bg-jcoder-secondary\"></div>\r\n                                                    <div className=\"flex-1\">\r\n                                                        <div className=\"h-4 w-24 bg-jcoder-secondary rounded mb-2\"></div>\r\n                                                        <div className=\"h-3 w-full bg-jcoder-secondary rounded\"></div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    ) : conversations.length === 0 ? (\r\n                                        <div className=\"p-8 text-center\">\r\n                                            <svg className=\"w-16 h-16 mx-auto text-jcoder-muted/50 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                                            </svg>\r\n                                            <p className=\"text-jcoder-muted\">No conversations yet</p>\r\n                                            <p className=\"text-sm text-jcoder-muted/70 mt-1\">Messages from your portfolio will appear here</p>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"divide-y divide-jcoder/50\">\r\n                                            {conversations.map((conversation) => (\r\n                                                <button\r\n                                                    key={conversation.id}\r\n                                                    onClick={() => handleSelectConversation(conversation)}\r\n                                                    className={`w-full p-4 text-left hover:bg-jcoder-secondary transition-colors cursor-pointer ${selectedConversation?.id === conversation.id ? 'bg-jcoder-secondary border-l-4 border-jcoder-primary' : ''\r\n                                                        }`}\r\n                                                >\r\n                                                    <div className=\"flex items-start gap-3\">\r\n                                                        {/* Avatar */}\r\n                                                        <div className=\"flex-shrink-0 w-12 h-12 rounded-full bg-jcoder-gradient flex items-center justify-center text-black font-semibold text-sm\">\r\n                                                            {getInitials(conversation.senderName)}\r\n                                                        </div>\r\n\r\n                                                        {/* Content */}\r\n                                                        <div className=\"flex-1 min-w-0\">\r\n                                                            <div className=\"flex items-center justify-between mb-1\">\r\n                                                                <h3 className=\"font-semibold text-sm text-jcoder-foreground truncate\">\r\n                                                                    {conversation.senderName}\r\n                                                                </h3>\r\n                                                                {conversation.lastMessageAt && (\r\n                                                                    <span className=\"text-xs text-jcoder-muted flex-shrink-0 ml-2\">\r\n                                                                        {formatDate(conversation.lastMessageAt)}\r\n                                                                    </span>\r\n                                                                )}\r\n                                                            </div>\r\n                                                            <div className=\"flex items-center justify-between gap-2\">\r\n                                                                <p className=\"text-xs text-jcoder-muted truncate flex-1\">\r\n                                                                    {conversation.lastMessagePreview || 'No messages'}\r\n                                                                </p>\r\n                                                                {conversation.unreadCount > 0 && (\r\n                                                                    <span className=\"flex-shrink-0 min-w-[20px] h-5 px-1.5 rounded-full bg-jcoder-blue text-white text-[10px] font-bold flex items-center justify-center shadow-lg shadow-jcoder-blue/50\">\r\n                                                                        {conversation.unreadCount > 9 ? '9+' : conversation.unreadCount}\r\n                                                                    </span>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </button>\r\n                                            ))}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Messages Area */}\r\n                            <div className=\"flex-1 flex flex-col bg-jcoder-card\">\r\n                                {selectedConversation ? (\r\n                                    <>\r\n                                        {/* Messages Header */}\r\n                                        <div className=\"p-4 border-b border-jcoder bg-jcoder-card flex items-center gap-3\">\r\n                                            <div className=\"w-10 h-10 rounded-full bg-jcoder-gradient flex items-center justify-center text-black font-semibold text-sm\">\r\n                                                {getInitials(selectedConversation.senderName)}\r\n                                            </div>\r\n                                            <div className=\"flex-1\">\r\n                                                <h3 className=\"font-semibold text-jcoder-foreground\">{selectedConversation.senderName}</h3>\r\n                                                <p className=\"text-xs text-jcoder-muted\">{selectedConversation.senderEmail}</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Messages List */}\r\n                                        <div ref={messagesContainerRef} className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n                                            {loadingMessages ? (\r\n                                                <div className=\"space-y-3\">\r\n                                                    {[1, 2, 3].map((i) => (\r\n                                                        <div key={i} className=\"flex justify-start\">\r\n                                                            <div className=\"max-w-xs lg:max-w-md bg-jcoder-secondary rounded-2xl p-3 animate-pulse\">\r\n                                                                <div className=\"h-4 w-full bg-jcoder-card rounded mb-2\"></div>\r\n                                                                <div className=\"h-4 w-3/4 bg-jcoder-card rounded\"></div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            ) : messages.length === 0 ? (\r\n                                                <div className=\"text-center py-12\">\r\n                                                    <svg className=\"w-16 h-16 mx-auto text-jcoder-muted/30 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                                                    </svg>\r\n                                                    <p className=\"text-jcoder-muted\">No messages in this conversation</p>\r\n                                                </div>\r\n                                            ) : (\r\n                                                <>\r\n                                                    {messages.map((message, index) => {\r\n                                                        const isRead = !!message.readAt;\r\n                                                        const prevMessage = index > 0 ? messages[index - 1] : null;\r\n                                                        const showDateSeparator = !prevMessage ||\r\n                                                            (() => {\r\n                                                                const currentDate = new Date(message.createdAt);\r\n                                                                const prevDate = new Date(prevMessage.createdAt);\r\n                                                                return currentDate.toDateString() !== prevDate.toDateString();\r\n                                                            })();\r\n\r\n                                                        const shouldShowDivider = newMessagesDividerIndex !== null && index === newMessagesDividerIndex;\r\n\r\n                                                        return (\r\n                                                            <div key={message.id}>\r\n                                                                {showDateSeparator && (\r\n                                                                    <div className=\"flex items-center justify-center my-4\">\r\n                                                                        <div className=\"px-3 py-1 bg-jcoder-secondary/50 rounded-full\">\r\n                                                                            <span className=\"text-xs text-jcoder-muted font-medium\">\r\n                                                                                {(() => {\r\n                                                                                    const d = typeof message.createdAt === 'string' ? new Date(message.createdAt) : message.createdAt;\r\n                                                                                    const now = new Date();\r\n                                                                                    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\r\n                                                                                    const messageDate = new Date(d.getFullYear(), d.getMonth(), d.getDate());\r\n                                                                                    const yesterday = new Date(today);\r\n                                                                                    yesterday.setDate(yesterday.getDate() - 1);\r\n\r\n                                                                                    if (messageDate.getTime() === today.getTime()) {\r\n                                                                                        return 'Today';\r\n                                                                                    } else if (messageDate.getTime() === yesterday.getTime()) {\r\n                                                                                        return 'Yesterday';\r\n                                                                                    } else {\r\n                                                                                        return d.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: d.getFullYear() !== now.getFullYear() ? 'numeric' : undefined });\r\n                                                                                    }\r\n                                                                                })()}\r\n                                                                            </span>\r\n                                                                        </div>\r\n                                                                    </div>\r\n                                                                )}\r\n                                                                {shouldShowDivider && (\r\n                                                                    <div className={`flex items-center justify-center my-4 transition-opacity duration-500 ${showNewMessagesDivider ? 'opacity-100' : 'opacity-0'}`}>\r\n                                                                        <div className=\"flex items-center gap-2 px-4 py-1.5 bg-jcoder-blue/20 border border-jcoder-blue/40 rounded-full backdrop-blur-sm\">\r\n                                                                            <div className=\"w-1.5 h-1.5 rounded-full bg-jcoder-blue animate-pulse\"></div>\r\n                                                                            <span className=\"text-xs text-jcoder-blue font-semibold\">Novas mensagens</span>\r\n                                                                            <div className=\"w-1.5 h-1.5 rounded-full bg-jcoder-blue animate-pulse\"></div>\r\n                                                                        </div>\r\n                                                                    </div>\r\n                                                                )}\r\n                                                                <div className=\"flex justify-start\">\r\n                                                                    <div className=\"max-w-xs lg:max-w-md bg-jcoder-secondary rounded-2xl p-3 relative border border-jcoder\">\r\n                                                                        <p className=\"text-sm text-jcoder-foreground whitespace-pre-wrap break-words\">\r\n                                                                            {message.message}\r\n                                                                        </p>\r\n                                                                        <div className=\"flex items-center justify-end gap-2 mt-2\">\r\n                                                                            <span className=\"text-xs text-jcoder-muted\">\r\n                                                                                {formatMessageTime(message.createdAt)}\r\n                                                                            </span>\r\n                                                                            {isRead && (\r\n                                                                                <svg className=\"w-4 h-4 text-blue-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                                                                                    <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                                                                                </svg>\r\n                                                                            )}\r\n                                                                        </div>\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        );\r\n                                                    })}\r\n                                                </>\r\n                                            )}\r\n                                            <div ref={messagesEndRef} />\r\n                                        </div>\r\n                                    </>\r\n                                ) : (\r\n                                    <div className=\"flex-1 flex items-center justify-center\">\r\n                                        <div className=\"text-center\">\r\n                                            <svg className=\"w-24 h-24 mx-auto text-jcoder-muted/30 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                                            </svg>\r\n                                            <p className=\"text-jcoder-muted text-lg font-medium\">Select a conversation</p>\r\n                                            <p className=\"text-sm text-jcoder-muted/70 mt-1\">Choose a conversation from the list to view messages</p>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Mobile: Stacked layout with view switching */}\r\n                        <div className=\"md:hidden flex-1 flex flex-col overflow-hidden\">\r\n                            {mobileView === 'conversations' ? (\r\n                                <>\r\n                                    {/* Conversations Header */}\r\n                                    <div className=\"p-4 border-b border-jcoder bg-jcoder-card\">\r\n                                        <h2 className=\"text-lg font-semibold text-jcoder-foreground\">Conversations</h2>\r\n                                        <p className=\"text-xs text-jcoder-muted mt-1\">\r\n                                            {conversations.length} {conversations.length === 1 ? 'conversation' : 'conversations'}\r\n                                        </p>\r\n                                    </div>\r\n\r\n                                    {/* Conversations List */}\r\n                                    <div className=\"flex-1 overflow-y-auto\">\r\n                                        {loading ? (\r\n                                            <div className=\"p-4 space-y-3\">\r\n                                                {[1, 2, 3].map((i) => (\r\n                                                    <div key={i} className=\"flex items-center gap-3 p-3 bg-jcoder-secondary rounded-lg animate-pulse\">\r\n                                                        <div className=\"w-12 h-12 rounded-full bg-jcoder-secondary\"></div>\r\n                                                        <div className=\"flex-1\">\r\n                                                            <div className=\"h-4 w-24 bg-jcoder-secondary rounded mb-2\"></div>\r\n                                                            <div className=\"h-3 w-full bg-jcoder-secondary rounded\"></div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                ))}\r\n                                            </div>\r\n                                        ) : conversations.length === 0 ? (\r\n                                            <div className=\"p-8 text-center\">\r\n                                                <svg className=\"w-16 h-16 mx-auto text-jcoder-muted/50 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                                                </svg>\r\n                                                <p className=\"text-jcoder-muted\">No conversations yet</p>\r\n                                                <p className=\"text-sm text-jcoder-muted/70 mt-1\">Messages from your portfolio will appear here</p>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <div className=\"divide-y divide-jcoder/50\">\r\n                                                {conversations.map((conversation) => (\r\n                                                    <button\r\n                                                        key={conversation.id}\r\n                                                        onClick={() => handleSelectConversation(conversation)}\r\n                                                        className=\"w-full p-4 text-left hover:bg-jcoder-secondary transition-colors cursor-pointer\"\r\n                                                    >\r\n                                                        <div className=\"flex items-start gap-3\">\r\n                                                            <div className=\"flex-shrink-0 w-12 h-12 rounded-full bg-jcoder-gradient flex items-center justify-center text-black font-semibold text-sm\">\r\n                                                                {getInitials(conversation.senderName)}\r\n                                                            </div>\r\n                                                            <div className=\"flex-1 min-w-0\">\r\n                                                                <div className=\"flex items-center justify-between mb-1\">\r\n                                                                    <h3 className=\"font-semibold text-sm text-jcoder-foreground truncate\">\r\n                                                                        {conversation.senderName}\r\n                                                                    </h3>\r\n                                                                    {conversation.lastMessageAt && (\r\n                                                                        <span className=\"text-xs text-jcoder-muted flex-shrink-0 ml-2\">\r\n                                                                            {formatDate(conversation.lastMessageAt)}\r\n                                                                        </span>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                                <div className=\"flex items-center justify-between gap-2\">\r\n                                                                    <p className=\"text-xs text-jcoder-muted truncate flex-1\">\r\n                                                                        {conversation.lastMessagePreview || 'No messages'}\r\n                                                                    </p>\r\n                                                                    {conversation.unreadCount > 0 && (\r\n                                                                        <span className=\"flex-shrink-0 min-w-[20px] h-5 px-1.5 rounded-full bg-jcoder-blue text-white text-[10px] font-bold flex items-center justify-center shadow-lg shadow-jcoder-blue/50\">\r\n                                                                            {conversation.unreadCount > 9 ? '9+' : conversation.unreadCount}\r\n                                                                        </span>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </button>\r\n                                                ))}\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    {/* Messages Header with Back Button */}\r\n                                    <div className=\"p-4 border-b border-jcoder bg-jcoder-card flex items-center gap-3\">\r\n                                        <button\r\n                                            onClick={handleBackToConversations}\r\n                                            className=\"p-2 hover:bg-jcoder-secondary rounded-lg transition-colors\"\r\n                                        >\r\n                                            <svg className=\"w-5 h-5 text-jcoder-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n                                            </svg>\r\n                                        </button>\r\n                                        {selectedConversation && (\r\n                                            <>\r\n                                                <div className=\"w-10 h-10 rounded-full bg-jcoder-gradient flex items-center justify-center text-black font-semibold text-sm\">\r\n                                                    {getInitials(selectedConversation.senderName)}\r\n                                                </div>\r\n                                                <div className=\"flex-1\">\r\n                                                    <h3 className=\"font-semibold text-jcoder-foreground\">{selectedConversation.senderName}</h3>\r\n                                                    <p className=\"text-xs text-jcoder-muted\">{selectedConversation.senderEmail}</p>\r\n                                                </div>\r\n                                            </>\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    {/* Messages List */}\r\n                                    <div ref={messagesContainerMobileRef} className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n                                        {loadingMessages ? (\r\n                                            <div className=\"space-y-3\">\r\n                                                {[1, 2, 3].map((i) => (\r\n                                                    <div key={i} className=\"flex justify-start\">\r\n                                                        <div className=\"max-w-xs bg-jcoder-secondary rounded-2xl p-3 animate-pulse\">\r\n                                                            <div className=\"h-4 w-full bg-jcoder-card rounded mb-2\"></div>\r\n                                                            <div className=\"h-4 w-3/4 bg-jcoder-card rounded\"></div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                ))}\r\n                                            </div>\r\n                                        ) : messages.length === 0 ? (\r\n                                            <div className=\"text-center py-12\">\r\n                                                <svg className=\"w-16 h-16 mx-auto text-jcoder-muted/30 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                                                </svg>\r\n                                                <p className=\"text-jcoder-muted\">No messages in this conversation</p>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <>\r\n                                                {messages.map((message, index) => {\r\n                                                    const isRead = !!message.readAt;\r\n                                                    const prevMessage = index > 0 ? messages[index - 1] : null;\r\n                                                    const showDateSeparator = !prevMessage ||\r\n                                                        (() => {\r\n                                                            const currentDate = new Date(message.createdAt);\r\n                                                            const prevDate = new Date(prevMessage.createdAt);\r\n                                                            return currentDate.toDateString() !== prevDate.toDateString();\r\n                                                        })();\r\n\r\n                                                    const shouldShowDivider = newMessagesDividerIndex !== null && index === newMessagesDividerIndex;\r\n\r\n                                                    return (\r\n                                                        <div key={message.id}>\r\n                                                            {showDateSeparator && (\r\n                                                                <div className=\"flex items-center justify-center my-4\">\r\n                                                                    <div className=\"px-3 py-1 bg-jcoder-secondary/50 rounded-full\">\r\n                                                                        <span className=\"text-xs text-jcoder-muted font-medium\">\r\n                                                                            {(() => {\r\n                                                                                const d = typeof message.createdAt === 'string' ? new Date(message.createdAt) : message.createdAt;\r\n                                                                                const now = new Date();\r\n                                                                                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\r\n                                                                                const messageDate = new Date(d.getFullYear(), d.getMonth(), d.getDate());\r\n                                                                                const yesterday = new Date(today);\r\n                                                                                yesterday.setDate(yesterday.getDate() - 1);\r\n\r\n                                                                                if (messageDate.getTime() === today.getTime()) {\r\n                                                                                    return 'Today';\r\n                                                                                } else if (messageDate.getTime() === yesterday.getTime()) {\r\n                                                                                    return 'Yesterday';\r\n                                                                                } else {\r\n                                                                                    return d.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: d.getFullYear() !== now.getFullYear() ? 'numeric' : undefined });\r\n                                                                                }\r\n                                                                            })()}\r\n                                                                        </span>\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            )}\r\n                                                            {shouldShowDivider && (\r\n                                                                <div className={`flex items-center justify-center my-4 transition-opacity duration-500 ${showNewMessagesDivider ? 'opacity-100' : 'opacity-0'}`}>\r\n                                                                    <div className=\"flex items-center gap-2 px-4 py-1.5 bg-jcoder-blue/20 border border-jcoder-blue/40 rounded-full backdrop-blur-sm\">\r\n                                                                        <div className=\"w-1.5 h-1.5 rounded-full bg-jcoder-blue animate-pulse\"></div>\r\n                                                                        <span className=\"text-xs text-jcoder-blue font-semibold\">Novas mensagens</span>\r\n                                                                        <div className=\"w-1.5 h-1.5 rounded-full bg-jcoder-blue animate-pulse\"></div>\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            )}\r\n                                                            <div className=\"flex justify-start\">\r\n                                                                <div className=\"max-w-[85%] bg-jcoder-secondary rounded-2xl p-3 relative border border-jcoder\">\r\n                                                                    <p className=\"text-sm text-jcoder-foreground whitespace-pre-wrap break-words\">\r\n                                                                        {message.message}\r\n                                                                    </p>\r\n                                                                    <div className=\"flex items-center justify-end gap-2 mt-2\">\r\n                                                                        <span className=\"text-xs text-jcoder-muted\">\r\n                                                                            {formatMessageTime(message.createdAt)}\r\n                                                                        </span>\r\n                                                                        {isRead && (\r\n                                                                            <svg className=\"w-4 h-4 text-blue-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                                                                                <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                                                                            </svg>\r\n                                                                        )}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    );\r\n                                                })}\r\n                                            </>\r\n                                        )}\r\n                                        <div ref={messagesEndRef} />\r\n                                    </div>\r\n                                </>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </main>\r\n\r\n            <Footer user={user} username={username || user?.username} />\r\n\r\n            <style jsx>{`\r\n                .delay-1000 {\r\n                    animation-delay: 1s;\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n}\r\n\r\n","import { Message, ConversationResponseDto, MarkMessagesReadDto } from '@/types/api/messages';\r\nimport { ApiService } from '../api.service';\r\n\r\nexport const MessagesService = {\r\n    /**\r\n     * Get all conversations (grouped by sender)\r\n     * GET /:username/messages/conversations\r\n     */\r\n    async findAllConversations(username: string): Promise<ConversationResponseDto[]> {\r\n        try {\r\n            const response = await ApiService.get(`/${username}/messages/conversations`);\r\n            // API returns { data: [...], success: true, ... }\r\n            return Array.isArray(response.data) ? response.data : (response.data?.data || []);\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get all messages from a specific conversation\r\n     * GET /:username/messages/conversations/:conversationId/messages\r\n     */\r\n    async findMessagesByConversation(username: string, conversationId: number): Promise<Message[]> {\r\n        try {\r\n            const response = await ApiService.get(`/${username}/messages/conversations/${conversationId}/messages`);\r\n            // API returns { data: [...], success: true, ... }\r\n            return Array.isArray(response.data) ? response.data : (response.data?.data || []);\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Mark messages as read in a conversation\r\n     * POST /:username/messages/conversations/:conversationId/mark-read\r\n     */\r\n    async markMessagesAsRead(\r\n        username: string,\r\n        conversationId: number,\r\n        data: MarkMessagesReadDto,\r\n    ): Promise<void> {\r\n        try {\r\n            await ApiService.post(`/${username}/messages/conversations/${conversationId}/mark-read`, data);\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get a specific message by ID\r\n     * GET /:username/messages/:id\r\n     */\r\n    async findById(username: string, id: number): Promise<Message> {\r\n        try {\r\n            const response = await ApiService.get(`/${username}/messages/${id}`);\r\n            // API returns { data: {...}, success: true, ... }\r\n            return response.data?.data || response.data;\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Delete a message (soft delete)\r\n     * DELETE /:username/messages/:id\r\n     */\r\n    async delete(username: string, id: number): Promise<void> {\r\n        try {\r\n            await ApiService.delete(`/${username}/messages/${id}`);\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n};\r\n\r\n"],"names":[],"mappings":"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"}